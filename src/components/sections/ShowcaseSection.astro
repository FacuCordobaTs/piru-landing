---
const steps = [
  {
    number: "01",
    title: "Escanean y exploran",
    description: "Se sientan, escanean el QR y cada uno navega el menú desde su celular. Sin apuro, a su ritmo.",
  },
  {
    number: "02",
    title: "Piden juntos, cada uno lo suyo",
    description: "Cada integrante de la mesa agrega lo que quiere. Todos ven el pedido completo en tiempo real.",
  },
  {
    number: "03",
    title: "Dividen la cuenta y listo",
    description: "Cada uno paga lo suyo con Mercado Pago o efectivo. Sin calculadora, sin esperas.",
  },
];
---

<section id="showcase-section" class="bg-secondary px-6 py-32 overflow-hidden">
  <div class="max-w-6xl mx-auto">
    <div class="text-center mb-16 showcase-header">
      <p class="text-primary text-sm uppercase tracking-widest mb-4">Cómo lo vive tu cliente</p>
      <h2 class="text-4xl md:text-5xl font-sans font-bold text-foreground mb-4">Así de fácil</h2>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 md:gap-12 showcase-steps">
      {steps.map((step, i) => (
        <div class="text-center showcase-step" data-index={i}>
          <div class="text-6xl md:text-7xl font-bold text-primary/20 mb-4">{step.number}</div>
          <h3 class="font-sans font-semibold text-2xl text-foreground mb-3">{step.title}</h3>
          <p class="text-muted-foreground leading-relaxed">{step.description}</p>
        </div>
      ))}
    </div>
  </div>
</section>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const section = document.getElementById('showcase-section');
    const header = document.querySelector('.showcase-header');
    const steps = document.querySelectorAll('.showcase-step');

    if (!section) return;

    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            const progress = entry.intersectionRatio;
            const scale = 0.8 + progress * 0.2;
            const opacity = progress * 2;

            const stepsContainer = document.querySelector('.showcase-steps');
            if (stepsContainer) {
              (stepsContainer as HTMLElement).style.transform = `scale(${scale})`;
              (stepsContainer as HTMLElement).style.opacity = Math.min(1, opacity).toString();
            }

            if (header && progress > 0.1) {
              header.classList.add('animate-fade-in-up');
            }

            steps.forEach((step, i) => {
              const index = parseInt((step as HTMLElement).dataset.index || '0');
              setTimeout(() => {
                if (progress > 0.2) {
                  step.classList.add('animate-fade-in-up');
                }
              }, index * 200);
            });
          }
        });
      },
      {
        threshold: Array.from({ length: 101 }, (_, i) => i / 100),
      }
    );

    observer.observe(section);
  });
</script>

<style>
  .showcase-header {
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.8s ease, transform 0.8s ease;
  }

  .showcase-header.animate-fade-in-up {
    opacity: 1;
    transform: translateY(0);
  }

  .showcase-steps {
    transform: scale(0.8);
    opacity: 0;
    transition: transform 0.8s ease, opacity 0.8s ease;
  }

  .showcase-step {
    opacity: 0;
    transform: translateY(30px);
    transition: opacity 0.8s ease, transform 0.8s ease;
  }

  .showcase-step.animate-fade-in-up {
    opacity: 1;
    transform: translateY(0);
  }
</style>
